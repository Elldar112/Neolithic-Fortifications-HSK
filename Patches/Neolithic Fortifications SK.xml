<?xml version="1.0" encoding="utf-8"?>
<Patch>

<!-- Architect Sense -->

  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/TerrainDef[@Name="FT_Palisade_Base"]/designationCategory</xpath>
    <value>
      <designationCategory>Security</designationCategory>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
	<xpath>Defs</xpath>
	<value>
		<ArchitectSense.DesignationSubCategoryDef>
			<defName>SubCategory_FortressNeolithic</defName>
			<label>Neolithic Fortifications</label>
			<description>Primitive defenses.</description>
			<order>1</order>
				<defNames>
					<li>FT_Palisade</li>
					<li>FT_Palisade_Embrasures</li>
					<li>FT_Palisade_Corner</li>
					<li>FT_CavalrySpike</li>
					<li>FT_Ditch</li>
				</defNames>
			<designationCategory>Security</designationCategory>
			<debug>false</debug>
		</ArchitectSense.DesignationSubCategoryDef>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic,ViTech.MedievalOverhaul"> <!-- Requires Vile Pre-Industrial-->
	<xpath>Defs</xpath>
	<value>
		<ArchitectSense.DesignationSubCategoryDef>
			<defName>SubCategory_FortressMedievalVile</defName>
			<label>Simple Fortifications</label>
			<description>Simple medieval defenses</description>
			<order>1</order>
				<defNames>
					<li>Pavise</li>
					<li>Valli</li>
					<li>StakeWall</li>
					<li>chevalDeFrise</li>
				</defNames>
			<designationCategory>Security</designationCategory>
			<debug>false</debug>
		</ArchitectSense.DesignationSubCategoryDef>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
	<xpath>Defs/ArchitectSense.DesignationSubCategoryDef[defName="SubCategory_Doors"]/defNames</xpath>
	<value>
		<li>FT_PalisadeDoor</li>
		<li>FT_PalisadeGate</li>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationRemove" MayRequire="Aoba.Fortress.Neolithic">
	<xpath>Defs/ArchitectSense.DesignationSubCategoryDef[defName="SubCategory_Fortifications"]/defNames/li[.="chevalDeFrise"]</xpath>
  </Operation>

<!-- Research -->
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade"
	or defName="FT_Palisade_Embrasures"
	or defName="FT_Palisade_Corner"
	or defName="FT_PalisadeDoor"
	or defName="FT_CavalrySpike"
	or defName="FT_Ditch"]
	</xpath>
    <value>
		<researchPrerequisites>
			<li>Fortification_A1</li>
		</researchPrerequisites>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
	<xpath>Defs/ThingDef[defName="FT_PalisadeGate"]/researchPrerequisites</xpath>
	<value>
		<researchPrerequisites>
			<li>Fortification_A1</li>
		</researchPrerequisites>
	</value>
  </Operation>

<!-- Cost -->

  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade" or defName="FT_Palisade_Corner"]/costStuffCount</xpath>
	<value>
		<costStuffCount>2</costStuffCount>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade_Embrasures"]/costStuffCount</xpath>
	<value>
		<costStuffCount>4</costStuffCount>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade" or defName="FT_Palisade_Embrasures" or defName="FT_Palisade_Corner"]</xpath>
	<value>
		<costList>
			<WoodLog>4</WoodLog>
		</costList>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade_Embrasures" or defName="FT_Palisade_Corner"]</xpath>
	<value>
		<costList>
			<ComponentMedieval>1</ComponentMedieval>
		</costList>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade_Embrasures" or defName="FT_PalisadeDoor" or defName="FT_PalisadeGate"]</xpath>
	<value>
		<costList>
			<ComponentMedieval>2</ComponentMedieval>
		</costList>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic,ViTech.MedievalOverhaul"> <!-- Requires Vile Pre-Industrial-->
    <xpath>Defs/ThingDef[defName="FT_CavalrySpike"]/costList</xpath>
	<value>
		<costList>
			<Sudis>4</Sudis>
		</costList>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_PalisadeGate"]</xpath>
	<value>
		<stuffCategories Inherit="False">
			<li>Woody</li>
		</stuffCategories>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_PalisadeDoor"]/stuffCategories</xpath>
	<value>
		<stuffCategories Inherit="False">
			<li>Woody</li>
		</stuffCategories>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Ditch"]/statBases/WorkToBuild</xpath>
	<value>
		<WorkToBuild>2600</WorkToBuild>
	</value>
  </Operation>
  
<!-- Stats -->

  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade" or defName="FT_Palisade_Embrasures" or defName="FT_Palisade_Corner"]/statBases/MaxHitPoints</xpath>
	<value>
		<MaxHitPoints>300</MaxHitPoints>
	</value>
  </Operation>

  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_PalisadeGate"]/statBases/MaxHitPoints</xpath>
	<value>
		<MaxHitPoints>550</MaxHitPoints>
	</value>
  </Operation>

<!-- Attributes --> 
 
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[@Name="FT_Palisade_Base"]/building</xpath>
    <value>
		<paintable>true</paintable>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade" or defName="FT_Palisade_Embrasures" or defName="FT_Palisade_Corner"]/building/relatedBuildCommands</xpath>
    <value>
		<li>FT_PalisadeDoor</li>
		<li>FT_PalisadeGate</li>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace" MayRequire="Aoba.Fortress.Neolithic">
	<xpath>Defs/ThingDef[defName="FT_PalisadeGate"]/graphicData/texPath</xpath>
	<value>
		<texPath>FT_PalisadeDoubleDoor_Mover</texPath>
	</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade_Embrasures" or defName="FT_Palisade" or defName="FT_Palisade_Corner" or defName="FT_PalisadeDoor" or defName="FT_PalisadeGate"]/building</xpath>
    <value>
        <canPlaceOverWall>true</canPlaceOverWall>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Aoba.Fortress.Neolithic">
    <xpath>Defs/ThingDef[defName="FT_Palisade"]/building</xpath>
    <value>
        <isPlaceOverableWall>true</isPlaceOverableWall>
    </value>
  </Operation>

</Patch>
